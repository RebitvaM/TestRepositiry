<h1>Задача</h1>
<p>Необходимо смоделировать изменение балансов студентов.</p>
<p>Для этого необходимо понимать:</p>
<li>сколько всего уроков было на балансе всех учеников за каждый календарный день;</li>
<li>как это количество менялось под влиянием транзакций (оплат, начислений, корректирующих списаний) и уроков (списаний с баланса по мере прохождения уроков).</li>
<p>В результате должна получиться таблица с балансами каждого студента каждый день</p>
<h1>Ход решения</h1>
<p>В ходе решения задачи составляется несколько CTE, которые формируют таблички с данными, применяемыми в последующих CTE и в итоговом запросе</p>
<h2>Шаг 1</h2>
<p>Создаём CTE с датой первой успешной транзакции для каждого пользователя</p>
<h2>Шаг 2</h2>
<p>Создаём CTE, хранящую все уникальные даты уроков</p>
<h2>Шаг 3</h2>
<p>Создаём CTE, хранящую все даты жизни каждого студента после первой транзакции</p>
<h2>Шаг 4</h2>
<p>Создаём CTE с датами покупки и изменением баланса у пользователя</p>
<h2>Шаг 5</h2>
<p>Создаём CTE, в которой для каждого пользователя отображается изменение в балансе в течение времени жизни на платформе</p>
<h2>Шаг 6</h2>
<p>Создаём CTE, в которой отображается id пользователя, дата занятия и число занятий в эту дату</p>
<h2>Шаг 7</h2>
<p>Создаём CTE, которая аналогична CTE из шага 5, но для числа занятий</p>
<h2>Шаг 8</h2>
<p>Создаём CTE с вычисленными балансами каждого студента</p>
<p>Теперь можно получить решение задания 1 из
  <a href="https://github.com/RebitvaM/TestRepositiry/blob/main/SQL%20Projects/%D0%A1%D0%BF%D0%B8%D1%81%D0%BE%D0%BA%20%D0%BF%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D0%BE%D0%B2.md">описания проектов</a></p>
<h2>Шаг 9</h2>
<p>Суммируем поля с изменениями баланса и проведёнными уроками, а также группируем эти данные по датам, что позволдяет решить задание 2 из
  <a href="https://github.com/RebitvaM/TestRepositiry/blob/main/SQL%20Projects/%D0%A1%D0%BF%D0%B8%D1%81%D0%BE%D0%BA%20%D0%BF%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D0%BE%D0%B2.md">описания проектов</a></p>
<h1>Выводы по результатам</h1>
<p> В полученных результатах можно увидеть как меняется баланс пользователей. Результат показывает, что иногда баланс студентов становился 
от рицательным, что означает либо ошибку в фиксации уроков/пополнений, либо эти занятия проходили в кредит. Помимо этого в 
ряде случаев было зафиксировано списание 3-4 уроков за сутки, а значит следует проверить эти данные, так как они веьма нереалестичны.</p>
